{"mappings":"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","sources":["math-facts.js"],"sourcesContent":["// Cached Elements Ã·\nlet upper = null;\nlet lower = null;\nlet op = null;\nlet answer = null;\nlet progress = null;\nlet progressOuter = null;\nlet correctCheck = null;\n\n// Sound Effects\nlet oneSound = null;\nlet goalSound = null;\nconst sounds = [\"none\", \"air-horn\", \"aooga\", \"applause\", \"ding-ding\", \"ding\", \"drama\", \"happy-tones\", \"mario-coin\", \"minecraft-eating\", \"success\", \"tada\", \"xylophone\"];\n\n// State\nlet currentProblem = null; // { answer: null, startTime: null, wasEverIncorrect: null };\n\nlet settings = { goal: 40, pauseMs: 500, op: '+', volume: 0.25, oneSound: sounds.indexOf(\"ding\"), goalSound: sounds.indexOf(\"tada\") };\nlet today = null;\nlet history = {};\nlet telemetry = { count: 0, accuracy: {}, speed: {} };\nlet shareText = null;\n\nlet cantSaveWarningShown = false;\nconst cantSaveWarningText = \"Can't save progress or settings with cookies disabled.\";\n\n// ---- Date Functions ----\n// Return this moment as a Date\nfunction now() {\n  return new Date();\n}\n\n// Return an ISO 8601 string for the given date in the local timezone (not UTC) (ex: '2022-08-31')\nfunction dateString(date) {\n  // \"sv\" locale (Sweden) uses ISO 8601 date formatting\n  return date.toLocaleDateString(\"sv\");\n}\n\n// Compute the date 'days' after 'date'\nfunction addDays(date, days) {\n  let result = new Date(date);\n  result.setDate(result.getDate() + days);\n  return result;\n}\n\n// Return the date of Sunday in the same week as 'date'\nfunction startOfWeek(date) {\n  return addDays(date, -date.getDay());\n}\n\n// ---- Basics: Load Settings and Progress, Choose Math Problems, Check Answers ----\n\n// Return the next problem to retry, if it's time and there are any\nfunction nextToRedo() {\n  const countToGoal = settings.goal - (today.count % settings.goal);\n  if (today.redo?.length >= countToGoal) {\n    return today.redo.shift();\n  } else {\n    return null;\n  }\n}\n\n// Choose a value between min and max.\n//  Don't re-choose last value if there are at least three options.\nfunction randomish(min, max, last) {\n  let options = (max - min) + 1;\n  let avoidLast = (options >= 3 && last >= min && last <= max);\n\n  if (options <= 1) { return max; }\n  if (avoidLast) { options--; }\n\n  let result = min + Math.floor(Math.random() * options);\n  if (result === last && avoidLast) { result = max; }\n\n  return result;\n}\n\n// Randomly choose the next math problem\nlet uMin = 0, uMax = 20, lMin = 0, lMax = 20;\n\nfunction nextProblem() {\n  let o = settings.op;\n  let u = parseInt(upper.innerText);\n  let l = parseInt(lower.innerText);\n  let a = null;\n  let redo = nextToRedo();\n\n  // Choose new problem (or a redo) to do next\n  if (redo) {\n    u = parseInt(redo[0]);\n    o = redo[1];\n    l = parseInt(redo[2]);\n    if (o === 'Ã·') { a = u / l; }\n  } else if (o === '+') {\n    u = randomish(Math.max(0, uMin), Math.min(12, uMax), u);\n    l = randomish(Math.max(0, lMin), Math.min(12, lMax), l);\n  } else if (o === '-') {\n    u = randomish(Math.max(0, lMin, uMin), Math.min(20, uMax), u);\n    l = randomish(Math.max(0, lMin), Math.min(u, lMax), l);\n  } else if (o === 'x') {\n    u = randomish(Math.max(0, uMin), Math.min(12, uMax), u);\n    l = randomish(Math.max(0, lMin), Math.min(12, lMax), l);\n  } else { // (o === 'Ã·')\n    // Choose *factors* and compute product; no zero.\n    a = randomish(Math.max(1, uMin), Math.min(12, uMax), a);\n    l = randomish(Math.max(1, lMin), Math.min(12, lMax), l);\n  }\n\n  // Compute correct answer\n  if (o === '+') {\n    a = u + l;\n  } else if (o === '-') {\n    a = u - l;\n  } else if (o === 'x') {\n    a = u * l;\n  } else { // (o === 'Ã·')\n    u = a * l;\n  }\n\n  // Update current problem state\n  currentProblem = { answer: a, wasEverIncorrect: false };\n  resetProblemTimer();\n\n  // Update UI\n  correctCheck.classList.remove(\"correct\");\n  correctCheck.classList.remove(\"correct-instant\");\n\n  upper.innerText = u;\n  op.innerText = o;\n  lower.innerText = l;\n\n  answer.value = \"\";\n  answer.focus();\n}\n\n// Reset the timer for solving the current problem (if any)\nfunction resetProblemTimer() {\n  if (currentProblem) { currentProblem.startTime = now(); }\n}\n\n// Check the answer\nfunction checkAnswer() {\n  const newNow = now();\n  const a = parseInt(answer.value);\n\n  // Stop if we are pending the next problem, or if no text is entered\n  if (currentProblem === null || answer.value === \"\") { return; }\n\n  // If correct, track progress, celebrate, and pick the next one\n  if (a === currentProblem.answer) {\n    // If it's a new day, push old data to history and swap to a new 'today'\n    if (dateString(newNow) !== today.date) {\n      loadState();\n    }\n\n    // Add just solved problem to telemetry\n    const msToAnswer = (newNow - currentProblem.startTime);\n    today.count++;\n\n    if (msToAnswer < 60 * 1000) {\n      const entry = [upper.innerText, op.innerText, lower.innerText, msToAnswer, currentProblem.wasEverIncorrect];\n      today.telemetry ??= [];\n      today.telemetry.push(entry);\n      addTelemetryEntry(entry);\n\n      if (currentProblem.wasEverIncorrect || msToAnswer >= 6000) {\n        today.redo ??= [];\n        today.redo.push(entry);\n      }\n    }\n\n    // Save new telemetry\n    try {\n      window.localStorage.setItem('today', JSON.stringify(today));\n    } catch {\n      if (!cantSaveWarningShown) {\n        cantSaveWarningShown = true;\n        showMessage(cantSaveWarningText);\n      }\n    }\n\n    // Update UI    \n    correctCheck.classList.add((settings.pauseMs >= 500 ? \"correct\" : \"correct-instant\"));\n    currentProblem = null;\n    showProgress();\n\n    // Play sound\n    if (today.count > 0 && today.count <= 3 * settings.goal && (today.count % settings.goal) === 0) {\n      play(goalSound);\n      showMessage(\"Yay!\");\n    } else {\n      play(oneSound);\n    }\n\n    // Show next problem (after brief delay)\n    setTimeout(nextProblem, settings.pauseMs ?? 250);\n  } else {\n    // If incorrect, and at least right length, mark wasEverIncorrect\n    if (a.toString().length >= currentProblem.answer.toString().length) {\n      currentProblem.wasEverIncorrect = true;\n    }\n  }\n}\n\n// Render progress on top bar\nfunction showProgress() {\n  if (today.count < settings.goal) {\n    progress.className = \"bronze\";\n    progressOuter.className = '';\n  } else if (today.count < 2 * settings.goal) {\n    progress.className = \"silver\";\n    progressOuter.className = \"bronze\";\n  } else if (today.count < 3 * settings.goal) {\n    progress.className = \"gold\";\n    progressOuter.className = \"silver\";\n  } else {\n    progress.className = '';\n    progressOuter.className = \"gold\";\n  }\n\n  const portionDone = (today.count % settings.goal) / settings.goal;\n  progress.style.backgroundSize = `${Math.floor(100 * portionDone)}% 100%`;\n}\n\n// Check to see if the day has rolled over\nfunction checkForTomorrow() {\n  // Reload state on a new day\n  if (dateString(now()) !== today.date) {\n    showMessage(\"Welcome Back!\");\n    loadState();\n  }\n\n  // Check hourly\n  window.setTimeout(checkForTomorrow, 60 * 60 * 1000);\n}\n\n// Load stored settings, progress today, and historical progress.\nfunction loadState() {\n  const currentToday = dateString(now());\n\n  try {\n    const storage = window.localStorage;\n    settings = { ...settings, ...JSON.parse(storage.getItem('settings')) };\n    history = JSON.parse(storage.getItem('history')) ?? history;\n\n    const lastToday = JSON.parse(storage.getItem('today'));\n    if (lastToday) {\n      if (lastToday.date === currentToday) {\n        // Reload 'today' data if it's still the same day\n        today = lastToday;\n      } else {\n        // Otherwise, add most recent day to history\n        history[lastToday.date] = lastToday;\n        storage.setItem(\"history\", JSON.stringify(history));\n\n        // TODO: Delete very old data?\n\n        // And start fresh\n        today = null;\n      }\n    }\n  }\n  catch { }\n\n  // Read any URL params\n  const params = new URLSearchParams(location.search);\n\n  const pGoal = parseInt(params.get(\"g\"));\n  if (pGoal) { settings.goal = pGoal; }\n\n  const pOp = params.get(\"o\");\n  if (pOp === '+' || pOp === '-' || pOp === 'x' || pOp === 'Ã·') { settings.op = pOp; }\n\n  const pVol = parseInt(params.get(\"v\"));\n  if (pVol >= 0 && pVol <= 100) { settings.volume = (pVol / 100); }\n\n  uMin = parseInt(params.get(\"u0\")) || 0;\n  uMax = parseInt(params.get(\"u1\")) || 20;\n  lMin = parseInt(params.get(\"l0\")) || 0;\n  lMax = parseInt(params.get(\"l1\")) || 20;\n\n  // Reset 'today' data\n  if (today == null) {\n    today = { date: currentToday, count: 0, telemetry: [] };\n  }\n\n  // Reflect loaded state in UI\n  op.innerText = settings.op;\n  showProgress();\n\n  // Calculate telemetry based on loaded history\n  computeTelemetry();\n\n  // Load sounds (asynchronously)\n  window.setTimeout(loadSounds, 50);\n}\n\n// Identify the next math operation in a fixed order\nfunction nextOperation(op) {\n  const ops = ['+', '-', 'x', 'Ã·'];\n  return ops[(ops.indexOf(op) + 1) % ops.length];\n}\n\n// Toggle the current math operation (when the operator is clicked)\nfunction toggleOperation() {\n  op.innerText = settings.op = nextOperation(settings.op);\n  saveSettings();\n  nextProblem();\n}\n\n// ---- Sound Effects ----\n\n// Load select sound effects\nfunction loadSounds() {\n  oneSound = loadSound(settings.oneSound ?? sounds.indexOf(\"ding\"), oneSound);\n  goalSound = loadSound(settings.goalSound ?? sounds.indexOf(\"tada\"), goalSound);\n}\n\n// Load a single sound (if 'None' not selected)\nfunction loadSound(index, currentAudio) {\n  currentAudio?.pause();\n  const name = sounds[(index || 0) % sounds.length];\n\n  if (name === \"none\" || settings.volume === 0) {\n    return null;\n  } else if (currentAudio?.src?.indexOf(`/${name}.mp3`) >= 0) {\n    return currentAudio;\n  } else {\n    const sound = new Audio(`./audio/${name}.mp3`);\n    sound.load();\n    return sound;\n  }\n}\n\n// Play sound; handle sound not allowed gracefully\nfunction play(audio, volume) {\n  if (audio == null) { return; }\n\n  audio.pause();\n  audio.currentTime = 0;\n  audio.volume = (volume ?? settings.volume ?? 1);\n  const promise = audio.play();\n  if (promise) {\n    promise.catch(error => { });\n  }\n}\n\n// ---- Control Bar ----\n\n// Show a Modal Box\nfunction show(id) {\n  let closeBox = document.createElement(\"template\");\n  closeBox.innerHTML = `<svg class=\"close-button\" title=\"Close\"><use href=\"#close\"></use></svg>`;\n\n  const container = document.getElementById(id);\n  container.children?.[0]?.prepend(closeBox.content);\n  container.classList.remove(\"hidden\");\n\n  document.querySelectorAll(\".close-button\").forEach((o) => o.addEventListener(\"click\", hide));\n}\n\n// Hide a Modal Box\nfunction hide() {\n  document.querySelectorAll(\".overlay\").forEach((o) => o.classList.add(\"hidden\"));\n  resetProblemTimer();\n  answer.focus();\n}\n\n// Don't hide a modal box (when clicking on box itself)\nfunction suppressHide(args) {\n  args.stopPropagation();\n}\n\n// Briefly show a message to the user\nfunction showMessage(message) {\n  const box = document.getElementById(\"temp-message\");\n  box.innerHTML = message;\n  box.classList.remove(\"hidden\");\n  box.classList.remove(\"show-message\");\n  window.setTimeout(() => box.classList.add(\"show-message\"), 10);\n}\n\n// ---- Telemetry Tracking ----\n\n// Compute telemetry summary for today and last 60 days of history\nfunction computeTelemetry(historyDayCount) {\n  historyDayCount ??= 60;\n\n  telemetry = { count: 0, accuracy: {}, speed: {}, rollup: { accuracy: {}, speed: {} } };\n\n  for (const entry of today.telemetry) {\n    addTelemetryEntry(entry);\n  }\n\n  const cutoff = dateString(addDays(now(), -1 * Math.abs(historyDayCount)));\n  for (let date in history) {\n    if (date >= cutoff) {\n      let dayTelemetry = history[date].telemetry;\n      if (dayTelemetry) {\n        for (const entry of dayTelemetry) {\n          addTelemetryEntry(entry);\n        }\n      }\n    }\n  }\n}\n\n// Add telemetry for a single problem entry\nfunction addTelemetryEntry(entry) {\n  const accuracy = telemetry.accuracy;\n  const speed = telemetry.speed;\n\n  const rAccuracy = telemetry.rollup.accuracy;\n  const rSpeed = telemetry.rollup.speed;\n\n  const u = entry[0];\n  const o = entry[1];\n  const l = entry[2];\n  const timeInMs = entry[3];\n  const wasEverIncorrect = entry[4];\n\n  // accuracy[\"2\"][\"+\"][\"3\"] = [20, 22]  (means \"2 + 3\" asked 22 times, correct on first try 20/22 times.)\n  accuracy[o] ??= {};\n  accuracy[o][u] ??= {};\n  accuracy[o][u][l] ??= [0, 0];\n  accuracy[o][u][l][0] += (wasEverIncorrect ? 0 : 1);\n  accuracy[o][u][l][1] += 1;\n\n  rAccuracy[o] ??= {};\n  if (op === '+' || op === 'x') {\n    rAccuracy[o][u] ??= [0, 0];\n    rAccuracy[o][u][0] += (wasEverIncorrect ? 0 : 1);\n    rAccuracy[o][u][1] += 1;\n  }\n  rAccuracy[o][l] ??= [0, 0];\n  rAccuracy[o][l][0] += (wasEverIncorrect ? 0 : 1);\n  rAccuracy[o][l][1] += 1;\n\n  // speed[\"2\"][\"x\"][\"4\"] = [1640, 2160, 850]  (means \"2 x 4\" asked three times and correct answer recieved in 1.64s, 2.16s, and 850 ms)\n  speed[o] ??= {};\n  speed[o][u] ??= {};\n  speed[o][u][l] ??= [];\n  speed[o][u][l].push(timeInMs);\n\n  rSpeed[o] ??= {};\n  if (op === '+' || op === 'x') {\n    rSpeed[o][u] ??= [];\n    rSpeed[o][u].push(timeInMs);\n  }\n  rSpeed[o][l] ??= [];\n  rSpeed[o][l].push(timeInMs);\n\n  telemetry.count++;\n}\n\n// ---- Speed and Accuracy Reports ----\n\nfunction getSpeedCell(column, operation, row) {\n  // For subtraction, only create cells for non-negative results\n  if (operation === '-' && column - row < 0) { return null; }\n\n  // Look up telemetry for problem\n  const u = (operation === 'Ã·' ? (column * row) : column);\n  const current = telemetry.speed?.[operation]?.[`${u}`]?.[`${row}`];\n\n  const td = document.createElement(\"td\");\n  td.title = `${u} ${operation} ${row}`;\n\n  if (current) {\n    current.sort((l, r) => l - r);\n    const medianMs = current[Math.floor(current.length / 2)];\n    const medianS = medianMs / 1000;\n    td.innerText = medianS.toLocaleString(\"en-US\", { minimumFractionDigits: (medianS < 9.5 ? 1 : 0), maximumFractionDigits: 1 });\n    td.className = speedClass(medianMs);\n  }\n\n  return td;\n}\n\nfunction getAccuracyCell(column, operation, row) {\n  // For subtraction, only create cells for non-negative results\n  if (operation === '-' && column - row < 0) { return null; }\n\n  // Look up telemetry for problem\n  const u = (operation === 'Ã·' ? (column * row) : column);\n  const current = telemetry.accuracy?.[operation]?.[`${u}`]?.[`${row}`];\n\n  const td = document.createElement(\"td\");\n  td.title = `${u} ${operation} ${row}`;\n\n  if (current) {\n    const accuracyPct = 100 * (current[0] / current[1]);\n    td.innerText = `${accuracyPct.toLocaleString(\"en-US\", { maximumFractionDigits: 0 })}`;\n    td.className = accuracyClass(accuracyPct);\n  }\n\n  return td;\n}\n\nfunction showTelemetryTable(operation, getTableCell) {\n  operation ??= '+';\n\n  let colHeadings = null;\n  let rowHeadings = null;\n\n  if (operation === '-') {\n    colHeadings = [20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0];\n    rowHeadings = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];\n  } else if (operation === 'Ã·') {\n    colHeadings = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n    rowHeadings = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n  } else {\n    colHeadings = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n    rowHeadings = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n  }\n\n  const table = createTable(operation, colHeadings, rowHeadings, getTableCell);\n  const container = document.getElementById(\"contents\");\n  container.innerHTML = \"\";\n  container.appendChild(table);\n  show(\"box\");\n}\n\nfunction createTable(operation, colHeadings, rowHeadings, getTableCell) {\n  const table = document.createElement(\"table\");\n  table.classList.add(\"stats\");\n  if (operation === '-') { table.classList.add(\"subtraction\"); }\n\n  let tr = null;\n  let td = null;\n\n  tr = document.createElement(\"tr\");\n\n  // Corner Cell\n  td = document.createElement(\"th\");\n  td.innerText = operation;\n  td.addEventListener('click', () => showTelemetryTable(nextOperation(operation), getTableCell));\n  tr.appendChild(td);\n\n  // First Row (column headings)\n  for (let x = 0; x < colHeadings.length; ++x) {\n    td = document.createElement(\"th\");\n    td.innerText = colHeadings[x];\n    tr.appendChild(td);\n  }\n\n  table.appendChild(tr);\n\n  for (let y = 0; y < rowHeadings.length; ++y) {\n    tr = document.createElement(\"tr\");\n\n    td = document.createElement(\"td\");\n    td.innerText = rowHeadings[y];\n    tr.appendChild(td);\n\n    for (let x = 0; x < colHeadings.length; ++x) {\n      const td = getTableCell(colHeadings[x], operation, rowHeadings[y]);\n      if (td) { tr.appendChild(td); }\n    }\n\n    table.appendChild(tr);\n  }\n\n  return table;\n}\n\nfunction speedClass(timeMs) {\n  if (timeMs == null) {\n    return \"unknown\";\n  } else if (timeMs < 2000) {\n    return \"great\";\n  } else if (timeMs < 3000) {\n    return \"good\";\n  } else if (timeMs < 6000) {\n    return \"ok\";\n  } else {\n    return \"bad\";\n  }\n}\n\nfunction accuracyClass(accuracyPct) {\n  if (accuracyPct == null) {\n    return \"unknown\";\n  } else if (accuracyPct >= 95) {\n    return \"great\";\n  } else if (accuracyPct >= 90) {\n    return \"good\";\n  } else if (accuracyPct >= 75) {\n    return \"ok\";\n  } else {\n    return \"bad\";\n  }\n}\n\n// ---- Consistency Calendar ----\n\nfunction showCalendar() {\n  const table = document.createElement(\"table\");\n  table.className = \"calendar\";\n\n  let tr = null;\n  let td = null;\n\n  // Header Row (day names)\n  const colHeadings = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n  tr = document.createElement(\"tr\");\n  for (let x = 0; x < colHeadings.length; ++x) {\n    td = document.createElement(\"th\");\n    td.innerText = colHeadings[x];\n    tr.appendChild(td);\n  }\n  table.appendChild(tr);\n\n  const end = now();\n  const startDate = addDays(startOfWeek(end), -21);\n  let current = startDate;\n\n  while (current <= end) {\n    tr = document.createElement(\"tr\");\n\n    for (let x = 0; x < 7; ++x) {\n      const td = document.createElement(\"td\");\n      const date = dateString(current);\n      const historyDay = (date === today.date ? today : history[date]);\n      const color = starColor(historyDay);\n      const showMonth = (current === startDate || current.getDate() === 1);\n\n      let contents = `<div class=\"date\">${(showMonth ? current.toLocaleString('en-US', { month: \"short\" }) : \"\")} ${current.toLocaleString('en-US', { day: \"numeric\" })}</div>`;\n      if (color) {\n        contents += `<svg class=\"fill-${color}\"><use href=\"#star\"></use</svg>`;\n      }\n\n      td.innerHTML = contents;\n      tr.appendChild(td);\n      current = addDays(current, 1);\n      if (current > end) { break; }\n    }\n\n    table.appendChild(tr);\n  }\n\n  const container = document.getElementById(\"contents\");\n  container.innerHTML = \"\";\n  container.appendChild(table);\n  show(\"box\");\n}\n\nfunction starColor(historyDay) {\n  if (historyDay == null) { return null; }\n\n  const count = historyDay.count;\n  if (count >= 3 * settings.goal) {\n    return \"gold\";\n  } else if (count >= 2 * settings.goal) {\n    return \"silver\";\n  } else if (count >= settings.goal) {\n    return \"bronze\";\n  } else {\n    return null;\n  }\n}\n\n// ---- Settings ----\n\nfunction addSounds(control) {\n  if (control.options.length === 0) {\n    for (let i = 0; i < sounds.length; ++i) {\n      const so = document.createElement(\"option\");\n      so.text = sounds[i];\n      control.add(so, i);\n    }\n  }\n}\n\nlet settingsLoaded = false;\n\nfunction showSettings() {\n  if (!settingsLoaded) {\n    const goal = document.getElementById(\"setting-goal\");\n    goal.value = settings.goal;\n    goal.addEventListener(\"input\", () => {\n      settings.goal = parseInt(goal.value);\n      saveSettings();\n      showProgress();\n    });\n    if (goal.value === \"\") { goal.value = 40; }\n\n    const oper = document.getElementById(\"setting-op\");\n    oper.value = op.innerText;\n    oper.addEventListener(\"input\", () => {\n      const newOp = oper.value;\n      op.innerText = newOp;\n      settings.op = newOp;\n      saveSettings();\n      nextProblem();\n    });\n\n    const delay = document.getElementById(\"setting-delay\");\n    delay.value = parseInt(settings.pauseMs);\n    delay.addEventListener(\"input\", () => {\n      settings.pauseMs = parseInt(delay.value);\n      saveSettings();\n    });\n\n    const volume = document.getElementById(\"setting-volume\");\n    volume.value = parseFloat(settings.volume);\n    volume.addEventListener(\"input\", () => {\n      settings.volume = parseFloat(volume.value);\n      saveSettings();\n      loadSounds();\n      play(oneSound || goalSound);\n    });\n\n    const eachSound = document.getElementById(\"setting-each-sound\");\n    addSounds(eachSound);\n    eachSound.selectedIndex = settings.oneSound;\n    eachSound.addEventListener(\"input\", () => {\n      settings.oneSound = eachSound.selectedIndex % sounds.length;\n      saveSettings();\n      oneSound = loadSound(settings.oneSound ?? 1, oneSound);\n      play(oneSound);\n    });\n\n    const setSound = document.getElementById(\"setting-goal-sound\");\n    addSounds(setSound);\n    setSound.selectedIndex = settings.goalSound;\n    setSound.addEventListener(\"input\", () => {\n      settings.goalSound = setSound.selectedIndex % sounds.length;\n      saveSettings();\n      goalSound = loadSound(settings.goalSound ?? 3, goalSound);\n      play(goalSound);\n    });\n  }\n\n  settingsLoaded = true;\n  show(\"settings-box\");\n}\n\nfunction saveSettings() {\n  try {\n    window.localStorage.setItem('settings', JSON.stringify(settings));\n  } catch {\n    if (!cantSaveWarningShown) {\n      cantSaveWarningShown = true;\n      showMessage(cantSaveWarningText);\n    }\n  }\n}\n\n// ---- Share ----  ðŸŸ§ ðŸŸª ðŸŸ« â¬œ ðŸ˜•\nconst emoji = {\n  \"unknown\": 'â¬›',\n  \"great\": 'ðŸŸ¦',\n  \"good\": 'ðŸŸ©',\n  \"ok\": 'ðŸŸ¨',\n  \"bad\": 'ðŸŸ¥',\n\n  \"gold\": 'ðŸŸ¨',\n  \"silver\": 'â¬œ',\n  \"bronze\": 'ðŸŸ§'\n};\n\nconst worstFirst = [null, \"unknown\", \"bad\", \"ok\", \"good\", \"great\"];\nfunction worst(class1, class2) {\n  return worstFirst[Math.min(worstFirst.indexOf(class1), worstFirst.indexOf(class2))];\n}\n\n// ---- Share Text ---- \nfunction showShare() {\n  const end = now();\n  let text = `${dateString(end)} | ${settings.goal} | ${settings.op}\\n\\n`;\n\n  let current = addDays(startOfWeek(end), -7);\n  text += `ðŸ“…\\n`;\n  while (current <= end) {\n    const date = dateString(current);\n    const historyDay = (date === today.date ? today : history[date]);\n    text += emoji[starColor(historyDay) ?? \"unknown\"];\n    if (current.getDay() === 6) { text += '\\n'; }\n    current = addDays(current, 1);\n  }\n  text += '\\n\\n';\n\n  computeTelemetry(14);\n  text += emojiTelemetrySummary(settings.op);\n  computeTelemetry(60);\n\n  const container = document.getElementById(\"share-text\");\n  container.innerHTML = text;\n  shareText = text;\n\n  let link = `mailto:?subject=Math Facts Summary&body=${encodeURIComponent(text)}`;\n  document.getElementById(\"share-mail\").href = link;\n\n  show(\"share-box\");\n}\n\nfunction emojiTelemetrySummary(o) {\n  let sText = 'âš¡ ';\n  let aText = 'ðŸŽ¯ ';\n\n  const speed = telemetry?.rollup?.speed[o];\n  const accuracy = telemetry?.rollup?.accuracy[o];\n  const start = (o === 'Ã·' ? 1 : 0);\n  const end = (o === '-' ? 20 : 12);\n\n  for (let i = start; i <= end; ++i) {\n    const current = speed?.[i];\n    current?.sort((l, r) => l - r);\n    const timeMs = current?.[Math.floor(current?.length * 0.75)] ?? null;\n    const accuracyPct = 100 * (accuracy?.[i]?.[0] / accuracy?.[i]?.[1]);\n\n    sText += emoji[speedClass(timeMs)];\n    aText += emoji[accuracyClass(accuracyPct)];\n  }\n\n  return aText + '\\n' + sText;\n}\n\nfunction copyShareToClipboard() {\n  navigator.clipboard.writeText(shareText);\n  showMessage(\"Copied to Clipboard!\");\n}\n\n// ---- Lame Hacks ----\n\n// Safari: Audio locked until first sound played in user action event handler.\n// 'input' event doesn't count, but 'click' does, so play on first body click to unlock audio.\nlet audioUnlocked = false;\nfunction unlockAudio() {\n  if (!audioUnlocked) {\n    audioUnlocked = true;\n    play(oneSound, 0);\n  }\n}\n\n// Safari + iPhone: On screen keyboard doesn't reduce viewport height.\n// Must shrink problem fonts manually to ensure it can be seen on screen.\nlet fontManuallyAdjusted = false;\nfunction onscreenKeyboardCheck() {\n  if (window.visualViewport && window.innerHeight !== window.visualViewport.height) {\n    // If less than the viewport height is *actually* showing, scale fonts via script\n    fontManuallyAdjusted = true;\n    document.getElementById(\"problem\").style.fontSize = (0.12 * window.visualViewport.height);\n    document.getElementById(\"answer\").style.fontSize = (0.12 * window.visualViewport.height);\n    document.getElementById(\"top-spacer\").style.flexGrow = 0;\n  } else if (fontManuallyAdjusted) {\n    // If fonts scaled and keyboard gone, go back to CSS-determined-values\n    fontManuallyAdjusted = false;\n    document.getElementById(\"problem\").style.fontSize = \"\";\n    document.getElementById(\"answer\").style.fontSize = \"\";\n    document.getElementById(\"top-spacer\").style.flexGrow = null;\n  }\n\n  // showMessage(`Resized to ${window.innerWidth} x ${window.innerHeight} ${window.visualViewport.height}`);\n}\n\n// ---------------------------------\n\nwindow.onload = async function () {\n  // Cache controls from DOM we'll be manipulating\n  upper = document.getElementById(\"upper\");\n  lower = document.getElementById(\"lower\");\n  op = document.getElementById(\"op\");\n  answer = document.getElementById(\"answer\");\n  progress = document.getElementById(\"progress\");\n  progressOuter = document.getElementById(\"progress-outer\");\n  correctCheck = document.getElementById(\"correct-check\");\n\n  // Load localStorage state (Settings, work per day, ...)\n  loadState();\n\n  // Hook up to check answer\n  answer.addEventListener(\"input\", checkAnswer);\n\n  // On op clicked, toggle op\n  op.addEventListener(\"click\", toggleOperation);\n\n  // Hook up hiding modal popups\n  document.querySelectorAll(\".overlay\").forEach((o) => o.addEventListener(\"click\", hide));\n  document.querySelectorAll(\".contents\").forEach((o) => o.addEventListener(\"click\", suppressHide));\n\n  // Hook up bar icons\n  document.getElementById(\"calendar-button\").addEventListener(\"click\", showCalendar);\n  document.getElementById(\"speed-button\").addEventListener(\"click\", () => showTelemetryTable(op.innerText, getSpeedCell));\n  document.getElementById(\"accuracy-button\").addEventListener(\"click\", () => showTelemetryTable(op.innerText, getAccuracyCell));\n\n  document.getElementById(\"share-button\").addEventListener(\"click\", showShare);\n  document.getElementById(\"help-button\").addEventListener(\"click\", () => show(\"help-box\"));\n  document.getElementById(\"settings-button\").addEventListener(\"click\", showSettings);\n  document.getElementById(\"share-clipboard\").addEventListener(\"click\", copyShareToClipboard);\n\n  // Hook up hacks (unlock audio, resize for on screen keyboard)\n  document.body.addEventListener(\"click\", unlockAudio);\n  window.addEventListener(\"resize\", onscreenKeyboardCheck);\n\n  // Check hourly for the day to roll over\n  window.setTimeout(checkForTomorrow, 60 * 60 * 1000);\n\n  // Reset problem start when browser loses and regains focus\n  window.addEventListener(\"focus\", resetProblemTimer);\n\n  // Choose the first problem\n  nextProblem();\n};"],"names":["$52425b95f1ca840c$var$upper","$52425b95f1ca840c$var$lower","$52425b95f1ca840c$var$op","$52425b95f1ca840c$var$answer","$52425b95f1ca840c$var$progress","$52425b95f1ca840c$var$progressOuter","$52425b95f1ca840c$var$correctCheck","$52425b95f1ca840c$var$oneSound","$52425b95f1ca840c$var$goalSound","$52425b95f1ca840c$var$sounds","$52425b95f1ca840c$var$currentProblem","$52425b95f1ca840c$var$settings","goal","pauseMs","op","volume","oneSound","indexOf","goalSound","$52425b95f1ca840c$var$today","$52425b95f1ca840c$var$history","$52425b95f1ca840c$var$telemetry","count","accuracy","speed","$52425b95f1ca840c$var$shareText","$52425b95f1ca840c$var$cantSaveWarningShown","$52425b95f1ca840c$var$now","Date","$52425b95f1ca840c$var$dateString","date","toLocaleDateString","$52425b95f1ca840c$var$addDays","days","result","setDate","getDate","$52425b95f1ca840c$var$startOfWeek","getDay","$52425b95f1ca840c$var$randomish","min","max","last","options","avoidLast","Math","floor","random","$52425b95f1ca840c$var$uMin","$52425b95f1ca840c$var$uMax","$52425b95f1ca840c$var$lMin","$52425b95f1ca840c$var$lMax","$52425b95f1ca840c$var$nextProblem","o","u","parseInt","innerText","l","a","redo","countToGoal","length","shift","$52425b95f1ca840c$var$nextToRedo","answer","wasEverIncorrect","$52425b95f1ca840c$var$resetProblemTimer","classList","remove","value","focus","startTime","$52425b95f1ca840c$var$checkAnswer","newNow","$52425b95f1ca840c$var$loadState","msToAnswer","entry","telemetry","push","$52425b95f1ca840c$var$addTelemetryEntry","window","localStorage","setItem","JSON","stringify","$52425b95f1ca840c$var$showMessage","add","$52425b95f1ca840c$var$showProgress","$52425b95f1ca840c$var$play","setTimeout","toString","className","portionDone","style","backgroundSize","$52425b95f1ca840c$var$checkForTomorrow","currentToday","storage","parse","getItem","lastToday","params","URLSearchParams","location","search","pGoal","get","pOp","pVol","$52425b95f1ca840c$var$computeTelemetry","$52425b95f1ca840c$var$loadSounds","$52425b95f1ca840c$var$nextOperation","ops","$52425b95f1ca840c$var$toggleOperation","$52425b95f1ca840c$var$saveSettings","$52425b95f1ca840c$var$loadSound","index","currentAudio","pause","name","src","sound","Audio","load","audio","currentTime","promise","play","catch","error","$52425b95f1ca840c$var$show","id","closeBox","document","createElement","innerHTML","container","getElementById","children","prepend","content","querySelectorAll","forEach","addEventListener","$52425b95f1ca840c$var$hide","$52425b95f1ca840c$var$suppressHide","args","stopPropagation","message","box","historyDayCount","rollup","cutoff","abs","dayTelemetry","entry1","rAccuracy","rSpeed","timeInMs","$52425b95f1ca840c$var$getSpeedCell","column","operation","row","current","td","title","sort","r","medianMs","medianS","toLocaleString","minimumFractionDigits","maximumFractionDigits","$52425b95f1ca840c$var$speedClass","$52425b95f1ca840c$var$getAccuracyCell","accuracyPct","$52425b95f1ca840c$var$accuracyClass","$52425b95f1ca840c$var$showTelemetryTable","getTableCell","colHeadings","rowHeadings","table","tr","appendChild","x","y","x1","td1","$52425b95f1ca840c$var$createTable","timeMs","$52425b95f1ca840c$var$showCalendar","end","startDate","color","$52425b95f1ca840c$var$starColor","contents","month","day","historyDay","$52425b95f1ca840c$var$addSounds","control","i","so","text","$52425b95f1ca840c$var$settingsLoaded","$52425b95f1ca840c$var$showSettings","oper","newOp","delay","parseFloat","eachSound","selectedIndex","setSound","$52425b95f1ca840c$var$emoji","unknown","great","good","ok","bad","gold","silver","bronze","$52425b95f1ca840c$var$showShare","sText","aText","$52425b95f1ca840c$var$emojiTelemetrySummary","link","encodeURIComponent","href","$52425b95f1ca840c$var$copyShareToClipboard","navigator","clipboard","writeText","$52425b95f1ca840c$var$audioUnlocked","$52425b95f1ca840c$var$unlockAudio","$52425b95f1ca840c$var$fontManuallyAdjusted","$52425b95f1ca840c$var$onscreenKeyboardCheck","visualViewport","innerHeight","height","fontSize","flexGrow","onload","async","body"],"version":3,"file":"index.d4ce9458.js.map"}